warning: unused import: `std::env`
  --> src/server/api_keys.rs:14:5
   |
14 | use std::env;
   |     ^^^^^^^^
   |
   = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: unused import: `crate::server::errors::AppError`
 --> src/server/start.rs:1:5
  |
1 | use crate::server::errors::AppError;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `serve::Serve`
 --> src/server/start.rs:2:34
  |
2 | use axum::{Router, routing::get, serve::Serve};
  |                                  ^^^^^^^^^^^^

warning: unused variable: `rate_limit_rps`
  --> src/server/start_simple.rs:17:5
   |
17 |     rate_limit_rps: u32,
   |     ^^^^^^^^^^^^^^
   |
   = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default
help: if this is intentional, prefix it with an underscore
   |
17 |     _rate_limit_rps: u32,
   |     +
help: you might have meant to pattern match on the similarly named constant `BRANCHES`
   |
17 -     rate_limit_rps: u32,
17 +     server::start::handle_double_ctrl_c::{closure#0}::BRANCHES: u32,
   |

warning: unused variable: `rate_limit_burst`
  --> src/server/start_simple.rs:18:5
   |
18 |     rate_limit_burst: u32,
   |     ^^^^^^^^^^^^^^^^
   |
help: if this is intentional, prefix it with an underscore
   |
18 |     _rate_limit_burst: u32,
   |     +
help: you might have meant to pattern match on the similarly named constant `BRANCHES`
   |
18 -     rate_limit_burst: u32,
18 +     server::start::handle_double_ctrl_c::{closure#0}::BRANCHES: u32,
   |

warning: function `create_tls_acceptor` is never used
   --> src/server/start.rs:114:10
    |
114 | async fn create_tls_acceptor(
    |          ^^^^^^^^^^^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: `static_embedding_server` (lib) generated 6 warnings (run `cargo fix --lib -p static_embedding_server` to apply 5 suggestions)
warning: `static_embedding_server` (lib test) generated 6 warnings (6 duplicates)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.48s
     Running unittests src/lib.rs (target/debug/deps/static_embedding_server-8acdc1d772a78dc7)

running 1 test
test server::api_keys::tests::test_api_key_generation_and_validation ... FAILED

failures:

---- server::api_keys::tests::test_api_key_generation_and_validation stdout ----

thread 'server::api_keys::tests::test_api_key_generation_and_validation' (22355667) panicked at src/server/api_keys.rs:453:9:
assertion `left == right` failed
  left: "development"
 right: "standard"
stack backtrace:
   0: __rustc::rust_begin_unwind
             at /rustc/dd7fda570040e8a736f7d8bc28ddd1b444aabc82/library/std/src/panicking.rs:698:5
   1: core::panicking::panic_fmt
             at /rustc/dd7fda570040e8a736f7d8bc28ddd1b444aabc82/library/core/src/panicking.rs:75:14
   2: core::panicking::assert_failed_inner
   3: core::panicking::assert_failed
             at /Users/jonathanhughes/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/panicking.rs:394:5
   4: static_embedding_server::server::api_keys::tests::test_api_key_generation_and_validation::{{closure}}
             at ./src/server/api_keys.rs:453:9
   5: <core::pin::Pin<P> as core::future::future::Future>::poll
             at /Users/jonathanhughes/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/future/future.rs:133:9
   6: <core::pin::Pin<P> as core::future::future::Future>::poll
             at /Users/jonathanhughes/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/future/future.rs:133:9
   7: tokio::runtime::scheduler::current_thread::CoreGuard::block_on::{{closure}}::{{closure}}::{{closure}}
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/scheduler/current_thread/mod.rs:742:70
   8: tokio::task::coop::with_budget
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/task/coop/mod.rs:167:5
   9: tokio::task::coop::budget
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/task/coop/mod.rs:133:5
  10: tokio::runtime::scheduler::current_thread::CoreGuard::block_on::{{closure}}::{{closure}}
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/scheduler/current_thread/mod.rs:742:25
  11: tokio::runtime::scheduler::current_thread::Context::enter
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/scheduler/current_thread/mod.rs:432:19
  12: tokio::runtime::scheduler::current_thread::CoreGuard::block_on::{{closure}}
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/scheduler/current_thread/mod.rs:741:44
  13: tokio::runtime::scheduler::current_thread::CoreGuard::enter::{{closure}}
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/scheduler/current_thread/mod.rs:829:68
  14: tokio::runtime::context::scoped::Scoped<T>::set
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/context/scoped.rs:40:9
  15: tokio::runtime::context::set_scheduler::{{closure}}
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/context.rs:176:38
  16: std::thread::local::LocalKey<T>::try_with
             at /Users/jonathanhughes/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/std/src/thread/local.rs:315:12
  17: std::thread::local::LocalKey<T>::with
             at /Users/jonathanhughes/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/std/src/thread/local.rs:279:20
  18: tokio::runtime::context::set_scheduler
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/context.rs:176:17
  19: tokio::runtime::scheduler::current_thread::CoreGuard::enter
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/scheduler/current_thread/mod.rs:829:27
  20: tokio::runtime::scheduler::current_thread::CoreGuard::block_on
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/scheduler/current_thread/mod.rs:729:24
  21: tokio::runtime::scheduler::current_thread::CurrentThread::block_on::{{closure}}
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/scheduler/current_thread/mod.rs:200:33
  22: tokio::runtime::context::runtime::enter_runtime
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/context/runtime.rs:65:16
  23: tokio::runtime::scheduler::current_thread::CurrentThread::block_on
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/scheduler/current_thread/mod.rs:188:9
  24: tokio::runtime::runtime::Runtime::block_on_inner
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/runtime.rs:356:52
  25: tokio::runtime::runtime::Runtime::block_on
             at /Users/jonathanhughes/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.47.1/src/runtime/runtime.rs:330:18
  26: static_embedding_server::server::api_keys::tests::test_api_key_generation_and_validation
             at ./src/server/api_keys.rs:461:46
  27: static_embedding_server::server::api_keys::tests::test_api_key_generation_and_validation::{{closure}}
             at ./src/server/api_keys.rs:440:54
  28: core::ops::function::FnOnce::call_once
             at /Users/jonathanhughes/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/ops/function.rs:250:5
  29: core::ops::function::FnOnce::call_once
             at /rustc/dd7fda570040e8a736f7d8bc28ddd1b444aabc82/library/core/src/ops/function.rs:250:5
note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.


failures:
    server::api_keys::tests::test_api_key_generation_and_validation

test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 7 filtered out; finished in 0.08s

error: test failed, to rerun pass `--lib`
